<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Benimle çıkar mısın? 💘</title>
<style>
  :root{
    --bg:#fff6fb; --card:#ffffff; --text:#2b2b2b; --yes:#ff4d8d; --no:#666ee8; --accent:#ffd1e4; --bar:#ffe2f0;
  }
  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--text);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial, "Apple Color Emoji","Segoe UI Emoji";
    background:
      radial-gradient(1200px 800px at 80% 10%, #ffe3f0 0%, rgba(255,227,240,0) 60%),
      radial-gradient(900px 600px at 10% 90%, #e8e9ff 0%, rgba(232,233,255,0) 55%),
      var(--bg);
    display:flex; align-items:center; justify-content:center; padding:24px;
  }
  .card{ width:min(720px, 100%); background:var(--card); border-radius:24px; box-shadow:0 10px 35px rgba(0,0,0,.08); padding:28px 22px 16px; position:relative; overflow:hidden; }
  h1{ margin:6px 0 14px; font-weight:800; font-size:clamp(22px, 3vw, 34px); text-align:center; line-height:1.2; }
  .subtitle{ text-align:center; margin-top:4px; color:#666; font-size:clamp(14px, 2.1vw, 16px); }
  .controls{ display:flex; gap:10px; justify-content:center; align-items:center; margin:14px 0 0; }
  .controls select{ border:1px solid #eee; border-radius:12px; padding:8px 12px; background:#fff; font-weight:700; }

  .meter{ width:88%; height:12px; margin:14px auto 0; background:var(--bar); border-radius:999px; overflow:hidden; position:relative; }
  .meter>div{ height:100%; width:0%; background:var(--yes); transition:width .25s ease; }

  .buttons{
    position:relative; min-height:92px;
    display:flex; gap:16px; justify-content:center; align-items:center; flex-wrap:wrap;
    margin:18px auto 10px;
  }

  button{
    border:none; border-radius:16px; padding:14px 18px; font-size:18px; font-weight:700; cursor:pointer;
    transition:transform .18s ease, box-shadow .18s ease, background-color .18s ease, color .18s ease, left .25s ease, top .25s ease, opacity .2s, transform .25s ease;
    box-shadow:0 6px 18px rgba(0,0,0,.08); min-width:120px;
  }
  #yesBtn{ background:var(--yes); color:#fff; transform:scale(1); }
  #yesBtn:hover{ transform:scale(1.06); }
  #noBtn{ background:var(--no); color:#fff; }
  #noBtn:hover{ transform:translateY(-2px); }

  .footer{ margin-top:8px; padding-top:10px; border-top:1px dashed #eee; }
  .mascotWrap{ display:flex; gap:12px; align-items:flex-end; justify-content:center; min-height:110px; position:relative; }
  .mascot{ font-size:64px; line-height:1; filter: drop-shadow(0 8px 16px rgba(0,0,0,.12)); transform-origin:bottom center; }
  .bubble{ max-width:min(520px, 85%); background:#fff; border:2px solid var(--accent); border-radius:16px; padding:10px 14px; font-weight:700; font-size:16px; position:relative; box-shadow:0 8px 24px rgba(0,0,0,.06); }
  .bubble:after{ content:""; position:absolute; bottom:-10px; left:40px; border:10px solid transparent; border-top-color:var(--accent); }

  @keyframes shake {0%,100%{transform:translateX(0)}20%{transform:translateX(-6px)}40%{transform:translateX(6px)}60%{transform:translateX(-4px)}80%{transform:translateX(4px)}}
  .shake{ animation:shake .4s ease both; }
  @keyframes pop {0%{ transform:scale(.7); opacity:0 } 100%{ transform:scale(1); opacity:1 }}
  .pop{ animation:pop .25s ease both; }

  .hearts, .confetti{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
  .heart{ position:absolute; font-size:24px; opacity:.9; animation: floatUp 1.8s ease-in forwards; will-change: transform, opacity; }
  @keyframes floatUp{ 0%{ transform:translateY(20px) scale(.8); opacity:0 } 20%{ opacity:1 } 100%{ transform:translateY(-140%) scale(1.4); opacity:0 } }
  .piece{ position:absolute; width:10px; height:14px; opacity:.95; animation: conf 1200ms ease-out forwards; }
  @keyframes conf{ 0%{ transform:translateY(0) rotate(0deg) } 100%{ transform:translateY(-140px) rotate(600deg); opacity:0 } }

  .credits{ text-align:center; color:#aaa; font-size:12px; margin-top:6px; }
  .tiny{font-size:12px; font-weight:600; color:#888; text-align:center;}

  /* Modal */
  dialog{
    border:none; border-radius:16px; padding:18px;
    box-shadow:0 20px 60px rgba(0,0,0,.2);
    width:min(520px, 92%);
  }
  dialog::backdrop{ background:rgba(0,0,0,.3) }
  .modal-grid{ display:grid; gap:10px; grid-template-columns:1fr 1fr; }
  .modal-grid label{ font-weight:700; font-size:14px; }
  .modal-grid input, .modal-grid textarea{
    width:100%; border:1px solid #e7e7e7; border-radius:12px; padding:10px 12px; font:inherit;
  }
  .modal-actions{ display:flex; gap:10px; justify-content:flex-end; margin-top:10px; }
  .btn-secondary{ background:#eee; color:#333; }
  .btn-primary{ background:var(--yes); color:#fff; }
  @media (max-width:520px){ .modal-grid{ grid-template-columns:1fr; } }
</style>
</head>
<body>
  <main class="card" role="main" aria-live="polite">
    <h1>Benimle çıkar mısın? 🥺</h1>
    <p class="subtitle">Naz yapmana saygımız sonsuz… ama <strong>Evet</strong> butonu da boş durmuyor 😉</p>

    <div class="controls">
      <label for="tone"><strong>“Hayır” tonu:</strong></label>
      <select id="tone" aria-label="Hayır tonu seç">
        <option value="sert" selected>Sert</option>
        <option value="nazli">Nazlı</option>
        <option value="komik">Komik</option>
      </select>
    </div>

    <div class="meter" aria-hidden="true"><div id="fill"></div></div>

    <section class="buttons">
      <button id="yesBtn" aria-label="Evet">Evet 💖</button>
      <button id="noBtn" aria-label="Hayır">Hayır</button>
      <div class="hearts" id="hearts"></div>
      <div class="confetti" id="confetti"></div>
    </section>

    <div class="footer">
      <div class="mascotWrap">
        <div id="mascot" class="mascot" aria-hidden="true">😊</div>
        <div id="bubble" class="bubble">Merhaba! Ben aşk danışmanı Maskot 🙋‍♂️</div>
      </div>
      <p class="tiny">Hayır’a bastıkça <em>Evet</em> büyür, “Hayır” inatlaşır; ben de yorum yaparım 👇</p>
    </div>

    <p class="credits">© Kalp Fabrikası</p>
  </main>

  <!-- Modal: Evet sonrası plan -->
  <dialog id="planModal">
    <form method="dialog">
      <h3 style="margin:0 0 10px 0; font-size:20px; font-weight:800;">Harika! İlk buluşmayı planlayalım 🎉</h3>
      <div class="modal-grid">
        <div>
          <label for="date">Tarih</label>
          <input id="date" type="date" required>
        </div>
        <div>
          <label for="time">Saat</label>
          <input id="time" type="time" required>
        </div>
        <div style="grid-column:1/-1">
          <label for="place">Mekan/Not</label>
          <textarea id="place" rows="3" placeholder="Örn: Sahilde yürüyüş + kahve ☕️"></textarea>
        </div>
      </div>
      <div class="modal-actions">
        <button class="btn-secondary" value="cancel">Vazgeç</button>
        <button id="savePlan" class="btn-primary" value="default">Kaydet</button>
      </div>
    </form>
  </dialog>

<script>
(function(){
  const yesBtn   = document.getElementById('yesBtn');
  const noBtn    = document.getElementById('noBtn');
  const mascot   = document.getElementById('mascot');
  const bubble   = document.getElementById('bubble');
  const hearts   = document.getElementById('hearts');
  const confetti = document.getElementById('confetti');
  const meter    = document.getElementById('fill');
  const toneSel  = document.getElementById('tone');
  const buttonsWrap = document.querySelector('.buttons');
  const modal   = document.getElementById('planModal');
  const saveBtn = document.getElementById('savePlan');
  const dateEl  = document.getElementById('date');
  const timeEl  = document.getElementById('time');
  const placeEl = document.getElementById('place');

  // Tonlara göre "hayır" replikleri
  const phrases = {
    sert: [
      "Hayır", "Hayııııır!", "Asla 😤", "Olmaz 😑", "Hayır dedim ya!",
      "Cevabım net: Hayır ❌", "Israr etme 😒", "Kesinlikle hayır.",
      "Bak hâlâ hayır diyorum 😠", "HAYIR!", "Bir kere daha: HAYIR 😤",
      "Konu kapanmıştır: Hayır."
    ],
    nazli: [
      "Hayır… ama tatlı sordun 😳", "Şimdilik hayır 🥺", "Belki sonra?",
      "Biraz daha ısrar et 🙈", "Kararsızım… yine de hayır", "Ufak bir hayırcık 🌸",
      "Ay olmaz şimdi 🙃", "Lütfen kızma… hayır", "Of tamam, hayır 😅",
      "Kalbim yumuşuyor ama hayır", "Naz yapıyorum, hayır 💕", "Hmm… hayır gibi 🤏"
    ],
    komik: [
      "Hayır.exe çalıştırıldı", "Hayıreeeet!", "404 Evet not found",
      "Nope nope nope 🐱‍👤", "Hayır: Deluxe Edition", "Hayır++",
      "Hayırlı bir hayır 😌", "Hayır^∞", "Hayır ama emojiyle: ❌",
      "Hayır ve üstüne sos", "Hayır turşulu", "Hayır… final cut 🎬"
    ]
  };
  let currentTone = 'sert';
  let noCount = 0;

  /* --- SES: Web Audio ile minik efektler --- */
  let audioCtx = null;
  function ping(freqStart=550, freqEnd=300, dur=0.08){
    try{
      audioCtx = audioCtx || new (window.AudioContext||window.webkitAudioContext)();
      const osc = audioCtx.createOscillator();
      const gain = audioCtx.createGain();
      osc.type = 'triangle';
      osc.frequency.setValueAtTime(freqStart, audioCtx.currentTime);
      osc.frequency.exponentialRampToValueAtTime(freqEnd, audioCtx.currentTime + dur);
      gain.gain.setValueAtTime(0.0001, audioCtx.currentTime);
      gain.gain.exponentialRampToValueAtTime(0.12, audioCtx.currentTime + dur/4);
      gain.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + dur);
      osc.connect(gain).connect(audioCtx.destination);
      osc.start(); osc.stop(audioCtx.currentTime + dur);
    }catch(e){/* sessizce geç */}
  }
  function popFX(){ ping(800, 400, 0.06); }
  function heartFX(){ ping(600, 520, 0.12); }

  function getNoText(){
    const list = phrases[currentTone];
    const idx = Math.min(noCount, list.length - 1);
    return list[idx];
  }

  function updateYesSize(){
    const scale = Math.min(1 + noCount * 0.18, 3.4);
    yesBtn.style.transform = `scale(${scale})`;
    const shrink = Math.max(1 - noCount * 0.05, 0.7);
    noBtn.style.transform = `scale(${shrink})`;
    const pct = Math.min((scale - 1) / (3.4 - 1) * 100, 100);
    meter.style.width = pct + '%';
  }

  function reactMascot(){
    let face = "😊", line = "Merhaba! Ben aşk danışmanı Maskot 🙋‍♂️";
    if(noCount === 0){ face="😊"; line="Hadi bakalım… ne diyeceksin?"; }
    else if(noCount <= 2){ face="🙂"; line="Naz kokuları alıyorum…"; }
    else if(noCount <= 4){ face="😟"; line="Bir şans versek mi acaba?"; }
    else if(noCount <= 6){ face="🥺"; line="Kalbim pıt pıt ediyor…"; }
    else if(noCount <= 8){ face="😢"; line="Gitgide üzülüyorum…"; }
    else if(noCount <= 10){ face="😭"; line="Bu aşkın günahı neydi?"; }
    else { face="😤"; line="Tamam! Evet de, tatlıya bağlayalım!"; }

    mascot.textContent = face;
    typeToBubble(line);
    mascot.classList.remove('shake'); bubble.classList.remove('pop');
    void mascot.offsetWidth; mascot.classList.add('shake'); bubble.classList.add('pop');
  }

  function typeToBubble(text){
    bubble.textContent = "";
    let i=0; const iv = setInterval(()=>{
      bubble.textContent += text[i++] || "";
      if(i>=text.length) clearInterval(iv);
    }, 14);
  }

  function spawnHearts(){
    const count = 16;
    const rect = yesBtn.getBoundingClientRect();
    for(let i=0;i<count;i++){
      const span = document.createElement('span');
      span.className = 'heart';
      span.textContent = ['💖','💗','💘','💝'][i%4];
      const startX = (rect.left + rect.width/2) + (Math.random()*80 - 40);
      span.style.left = (startX - buttonsWrap.getBoundingClientRect().left) + 'px';
      span.style.bottom = '10px';
      span.style.fontSize = (18 + Math.random()*18) + 'px';
      span.style.animationDelay = (Math.random()*0.5)+'s';
      hearts.appendChild(span);
      span.addEventListener('animationend', ()=> span.remove());
    }
    heartFX();
  }

  function spawnConfetti(){
    const colors = ["#ff4d8d","#ffd166","#06d6a0","#118ab2","#ef476f","#8338ec"];
    const pieces = 60;
    const area = buttonsWrap.getBoundingClientRect();
    for(let i=0;i<pieces;i++){
      const d = document.createElement('div');
      d.className = 'piece';
      d.style.left = (Math.random()*area.width) + 'px';
      d.style.bottom = '0px';
      d.style.background = colors[i % colors.length];
      d.style.transform = `translateY(${Math.random()*20}px) rotate(${Math.random()*360}deg)`;
      d.style.animationDelay = (Math.random()*0.4)+'s';
      confetti.appendChild(d);
      d.addEventListener('animationend', ()=> d.remove());
    }
  }

  function makeNoEvasive(){
    // 3'ten sonra kaçma, 8'den sonra tamamen kaçış animasyonu
    if(noCount >= 8){
      noBtn.style.transition = 'transform .5s ease, opacity .5s ease';
      noBtn.style.transform = 'translate(120vw, -80vh) rotate(25deg) scale(0.8)';
      noBtn.style.opacity = '0';
      noBtn.disabled = true;
      typeToBubble("Tamam, kaçtı gitti… şimdi cevabın netleşti mi? 😌");
      return;
    }
    if(noCount < 3) return;
    if(getComputedStyle(noBtn).position !== 'absolute'){
      noBtn.style.position = 'absolute';
    }
    const wrapRect = buttonsWrap.getBoundingClientRect();
    const btnRect = noBtn.getBoundingClientRect();
    const maxLeft = wrapRect.width - btnRect.width;
    const maxTop  = Math.max(10, wrapRect.height - btnRect.height);
    const left = Math.max(0, Math.random()*maxLeft);
    const top  = Math.max(0, Math.random()*maxTop);
    noBtn.style.left = left + 'px';
    noBtn.style.top  = top  + 'px';
  }

  // Olaylar
  toneSel.addEventListener('change', (e)=>{
    currentTone = e.target.value;
    noBtn.textContent = getNoText();
    popFX();
  });

  noBtn.addEventListener('click', ()=>{
    noCount++;
    updateYesSize();
    noBtn.textContent = getNoText();
    reactMascot();
    makeNoEvasive();
    popFX();
  });

  yesBtn.addEventListener('click', ()=>{
    typeToBubble("YAAAAŞASIN! 🎉 Harika bir çift olacağız!");
    mascot.textContent = "🤩";
    spawnHearts();
    spawnConfetti();
    popFX();

    noBtn.disabled = true; noBtn.style.opacity = .35;
    yesBtn.textContent = "Anlaştık! 💞";
    yesBtn.style.transition = 'transform .18s ease';
    yesBtn.style.transform = 'scale(1.15)';
    setTimeout(()=> updateYesSize(), 300);

    // Modal aç
    if(typeof modal.showModal === 'function'){ modal.showModal(); }
  });

  // Modal kaydet
  saveBtn.addEventListener('click', (e)=>{
    e.preventDefault();
    const d = dateEl.value, t = timeEl.value, p = placeEl.value.trim();
    if(!d || !t){ return; }
    modal.close();
    const nice = new Date(`${d}T${t}`);
    const trDate = nice.toLocaleDateString('tr-TR', {weekday:'long', day:'2-digit', month:'long'});
    const trTime = nice.toLocaleTimeString('tr-TR', {hour:'2-digit', minute:'2-digit'});
    const plan = `Süper! ${trDate} ${trTime} için planımız hazır. ${p?("Not: "+p):""} 💌`;
    typeToBubble(plan);
    heartFX();
  });

  // İlk yükleme
  noBtn.textContent = getNoText();
  reactMascot();
})();
</script>
</body>
</html>
