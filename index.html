<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
<title>Benimle Ã§Ä±kar mÄ±sÄ±n? â€” ultra plus+</title>
<style>
  :root{
    --bg0:#101024; --bg1:#1b1c33; --ink:#eef0ff; --muted:#aab0cc;
    --glass: rgba(255,255,255,.10); --border: rgba(255,255,255,.16);
    --yes:#a46bff; --yes2:#d47cff; --no:#7c86ff; --no2:#9eb0ff;
    --blob1:#c38bff; --blob2:#8fa0ff; --blob3:#2ee6a6;
    --yes-scale:1; --yes-font:1rem; --yes-pad:16px 24px; --btns-minh:120px;
  }
  [data-theme="deniz"]{ --bg0:#081a22; --bg1:#0f2a33; --ink:#e9f6ff; --muted:#9fb7c3; --yes:#00b3ff; --yes2:#4dd5ff; --no:#009a9a; --no2:#26c6c6; --blob1:#00c2ff; --blob2:#00e6c3; --blob3:#7af0ff; }
  [data-theme="gunes"]{ --bg0:#231403; --bg1:#321f07; --ink:#fff6e6; --muted:#d9c1a3; --yes:#ff8a00; --yes2:#ffbb33; --no:#ff4d5a; --no2:#ff808a; --blob1:#ffcc66; --blob2:#ff8a66; --blob3:#ffd54d; }
  [data-theme="zumrut"]{ --bg0:#061511; --bg1:#0a221b; --ink:#e3fff6; --muted:#a6cbbf; --yes:#00c98b; --yes2:#43e6aa; --no:#3aa1ff; --no2:#79c2ff; --blob1:#00e6a6; --blob2:#38dfff; --blob3:#66ffcc; }

  *{box-sizing:border-box}
  html,body{height:100%}
  body{
    margin:0; color:var(--ink);
    font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Helvetica Neue", Arial;
    background:
      radial-gradient(1200px 800px at 18% 10%, color-mix(in oklab, var(--blob1) 28%, transparent), transparent 55%),
      radial-gradient(1200px 800px at 82% 90%, color-mix(in oklab, var(--blob2) 28%, transparent), transparent 55%),
      linear-gradient(120deg, var(--bg0), var(--bg1));
    min-height:100%; overflow-x:hidden;
  }
  .scene{ min-height:100dvh; display:grid; place-items:center; padding: max(16px, env(safe-area-inset-top)) 16px 28px; }
  .blobs{ position:fixed; inset:0; pointer-events:none; filter: blur(48px) saturate(120%); opacity:.55 }
  .blob{ position:absolute; width:44vmax; height:44vmax; border-radius:50%;
    background: radial-gradient(circle at 30% 30%, var(--blob1), transparent 60%);
    mix-blend-mode: plus-lighter; animation: float 18s ease-in-out infinite;
  }
  .blob.b2{ right:-12%; top:8%; background:radial-gradient(circle at 70% 30%, var(--blob2), transparent 60%); animation-duration:22s }
  .blob.b3{ left:40%; top:70%; background:radial-gradient(circle at 50% 50%, var(--blob3), transparent 60%); animation-duration:24s }
  @keyframes float{ 0%,100%{ transform:translate(0,0) scale(1)} 50%{ transform:translate(3%, -6%) scale(1.06)} }

  .card{
    width:min(900px, 100%); background: var(--glass); border:1px solid var(--border); border-radius:28px;
    backdrop-filter: blur(16px) saturate(120%); -webkit-backdrop-filter: blur(16px) saturate(120%);
    padding: clamp(20px, 4vw, 40px); box-shadow: 0 14px 40px rgba(0,0,0,.22), inset 0 1px 0 rgba(255,255,255,.14);
    position:relative; overflow:visible; transform-style:preserve-3d;
  }
  .shine{ position:absolute; inset:-1px; border-radius:inherit; pointer-events:none;
    background: radial-gradient(700px 340px at var(--mx,60%) var(--my,20%), rgba(255,255,255,.35), transparent 60%); opacity:.7; transition:opacity .3s ease; }
  h1{ margin:0 0 6px; text-align:center; line-height:1.05; font-size:clamp(28px, 6vw, 52px); font-weight:900; letter-spacing:-.02em;
      background:linear-gradient(90deg,var(--yes),var(--yes2)); -webkit-background-clip:text; background-clip:text; color:transparent; }
  .sub{ margin:0; text-align:center; color:var(--muted); font-size:clamp(14px, 3vw, 17px) }

  .toggles{ display:flex; gap:10px; justify-content:center; align-items:center; flex-wrap:wrap; margin-top:10px; }
  .chip{ display:inline-flex; gap:8px; align-items:center; background:var(--glass); border:1px solid var(--border);
         padding:8px 12px; border-radius:999px; font-weight:800; font-size:14px; }
  .chip input{ accent-color: var(--yes); width:18px; height:18px }

  /* ipucu karuseli */
  .tips{ display:grid; grid-auto-flow:column; grid-auto-columns:minmax(220px,1fr); gap:10px; overflow:auto hidden; padding:8px 2px; scroll-snap-type:x mandatory; }
  .tip{ scroll-snap-align:center; background:rgba(255,255,255,.08); border:1px solid var(--border); border-radius:14px; padding:12px; font-weight:800; text-align:center }
  .tip small{ display:block; opacity:.7; font-weight:700 }

  .buttons{
    position:relative; margin:min(6vw,30px) auto 12px;
    display:grid; grid-template-columns:1fr 1fr; gap:14px; align-items:center; justify-items:center;
    min-height: var(--btns-minh);
  }
  @media (max-width:560px){ .buttons{ grid-template-columns:1fr; } }

  button{
    border:none; border-radius:16px; cursor:pointer; touch-action:manipulation;
    min-height:56px; min-width: clamp(220px, 40%, 360px);
    font-weight:900; letter-spacing:.2px;
    transition: transform .18s cubic-bezier(.2,.9,.2,1), background-color .18s ease, color .18s ease, box-shadow .18s ease, opacity .18s ease;
    box-shadow: 0 10px 28px rgba(0,0,0,.20);
  }
  .btn-yes{ background: linear-gradient(135deg, var(--yes), var(--yes2)); color:#fff;
            transform: translateZ(0) scale(var(--yes-scale)); font-size: calc(var(--yes-font)); padding: var(--yes-pad); position:relative; z-index:2; }
  .btn-yes:active{ transform:scale(calc(var(--yes-scale)*.985)); }
  .btn-no{ background: linear-gradient(135deg, var(--no), var(--no2)); color:#fff; padding:16px 24px; font-size:1rem; position:relative; z-index:1; }
  .btn-no:active{ opacity:.9 }
  .btn-no.evasive{ position:absolute !important; }

  /* ilerleme halkasÄ± */
  .prog{ width:92px; height:92px; position:absolute; right:8px; top:8px; opacity:.9 }
  .prog circle{ fill:none; stroke-width:10; stroke-linecap:round }
  .prog .bg{ stroke:rgba(255,255,255,.2) }
  .prog .fg{ stroke:url(#grad); stroke-dasharray:283; stroke-dashoffset:283; transition: stroke-dashoffset .25s ease }

  .fx, .confetti{ position:absolute; inset:0; pointer-events:none; overflow:hidden; }
  .fx{ filter:url(#goo) }
  .heart{ position:absolute; font-size:22px; animation: rise 2s ease-in forwards; opacity:0; }
  @keyframes rise{ 0%{ transform: translateY(10px) scale(.7); opacity:0 } 15%{ opacity:1 } 100%{ transform: translateY(-170%) scale(1.5); opacity:0 } }
  .piece{ position:absolute; width:10px; height:14px; border-radius:2px; opacity:.95; animation: conf 1.2s ease-out forwards }
  @keyframes conf{ 0%{ transform:translateY(0) rotate(0) } 100%{ transform:translateY(-160px) rotate(720deg); opacity:0 } }

  .smart{ display:none; gap:10px; justify-content:center; flex-wrap:wrap; margin-top:14px }
  .smart.show{ display:flex }
  .btn-outline{ background:transparent; color:var(--ink); border:1px solid var(--border); padding:12px 16px; border-radius:12px; font-weight:800; backdrop-filter: blur(8px); }

  .avatar{ display:flex; gap:16px; justify-content:center; align-items:center; flex-wrap:wrap; margin-top:10px; }
  .face{ width: clamp(88px, 22vw, 120px); height:auto; filter: drop-shadow(0 10px 22px rgba(0,0,0,.28)) }
  .bubble{ background: rgba(255,255,255,.75); border:1px solid rgba(255,255,255,.6); padding:12px 16px; border-radius:14px; font-weight:800; backdrop-filter: blur(8px); max-width:min(600px, 92%); text-align:center; color:inherit; font-size:clamp(14px, 3.4vw, 16px) }
  @media (prefers-color-scheme: dark){ .bubble{ background: rgba(32,32,48,.55); border-color: rgba(255,255,255,.12) } }

  /* mini-oyun overlay */
  .mini{ position:absolute; inset:0; background:rgba(0,0,0,.28); display:none; align-items:center; justify-content:center; backdrop-filter: blur(6px); border-radius:28px; }
  .mini.show{ display:flex }
  .miniBox{ background:var(--glass); border:1px solid var(--border); border-radius:18px; padding:16px; width:min(560px,92%); box-shadow:0 10px 30px rgba(0,0,0,.25); text-align:center }
  .arena{ position:relative; height:220px; margin-top:12px; border-radius:14px; border:1px dashed var(--border); overflow:hidden }
  .catch{ position:absolute; background: linear-gradient(135deg, var(--yes), var(--yes2)); color:#fff; border:0; border-radius:999px; padding:10px 18px; font-weight:900; }
  .timer{ font-weight:900; opacity:.8 }

  .parallax{ height:70dvh; display:grid; place-items:center; color:#fff; text-align:center; font-weight:900; letter-spacing:.3px; }
  .p1{ background-attachment: fixed; background-image: radial-gradient(600px 600px at 20% 30%, color-mix(in oklab, var(--blob1) 35%, transparent), transparent 60%), linear-gradient(120deg, var(--bg0), transparent); }
  .p2{ background-attachment: fixed; background-image: radial-gradient(600px 600px at 80% 70%, color-mix(in oklab, var(--blob2) 35%, transparent), transparent 60%), linear-gradient(120deg, transparent, var(--bg1)); }
</style>
</head>
<body>
  <div class="blobs" aria-hidden="true">
    <div class="blob b1" style="left:-8%; top:-6%"></div>
    <div class="blob b2"></div>
    <div class="blob b3"></div>
  </div>

  <section class="scene">
    <main class="card" id="card" aria-live="polite">
      <div class="shine"></div>

      <h1>Benimle Ã§Ä±kar mÄ±sÄ±n?</h1>
      <p class="sub">Her â€œHayÄ±râ€dan sonra <strong>Evet</strong> biraz daha ikna olur. BakalÄ±m nereye kadarâ€¦</p>

      <div class="toggles">
        <label class="chip"><input type="checkbox" id="mute"> Sessiz</label>
        <label class="chip"><input type="checkbox" id="tts"> Sesli avatar</label>
        <label class="chip"><input type="checkbox" id="asr"> Sesle cevap (beta)</label>
      </div>

      <!-- Ä°pucu karuseli -->
      <div class="tips" id="tips">
        <div class="tip"><small>#1</small> Beraber kahve? â˜•</div>
        <div class="tip"><small>#2</small> Sahil yÃ¼rÃ¼yÃ¼ÅŸÃ¼? ğŸŒŠ</div>
        <div class="tip"><small>#3</small> Mini pizza + film? ğŸ•ğŸ¬</div>
        <div class="tip"><small>#4</small> KitapÃ§Ä± turu ğŸ“š</div>
        <div class="tip"><small>#5</small> GÃ¼n batÄ±mÄ± foto turu ğŸ“¸ğŸŒ‡</div>
      </div>

      <!-- Ä°lerleme halkasÄ± -->
      <svg class="prog" viewBox="0 0 100 100" aria-hidden="true">
        <defs><linearGradient id="grad" x1="0" y1="0" x2="1" y2="1"><stop offset="0" stop-color="var(--yes)"/><stop offset="1" stop-color="var(--yes2)"/></linearGradient></defs>
        <circle class="bg" cx="50" cy="50" r="45"></circle>
        <circle class="fg" id="ring" cx="50" cy="50" r="45"></circle>
      </svg>

      <div class="buttons" id="buttons">
        <button class="btn-yes" id="yes" aria-label="Evet">Evet</button>
        <button class="btn-no"  id="no"  aria-label="HayÄ±r">HayÄ±r</button>
        <div class="fx" id="fx"></div>
        <div class="confetti" id="confetti"></div>
      </div>

      <!-- Mini Oyun -->
      <div class="mini" id="mini">
        <div class="miniBox">
          <div><strong>Evetâ€™i yakala!</strong> <span class="timer" id="timer">10</span> sn</div>
          <div class="arena" id="arena">
            <button class="catch" id="catch">Evet!</button>
          </div>
        </div>
      </div>

      <!-- Evet sonrasÄ± seÃ§enekler -->
      <div class="smart" id="smart">
        <button class="btn-outline" id="btnSmart">Mesaj At (AkÄ±llÄ±)</button>
        <button class="btn-outline" id="btnWA">WhatsApp</button>
        <button class="btn-outline" id="btnIG">Instagram</button>
        <button class="btn-outline" id="btnShare">PaylaÅŸ</button>
        <button class="btn-outline" id="btnICS">Takvime Ekle (.ics)</button>
      </div>

      <!-- Avatar -->
      <div class="avatar">
        <svg id="face" class="face" viewBox="0 0 120 120" aria-hidden="true">
          <defs><radialGradient id="heartG" cx="40%" cy="35%" r="70%"><stop offset="0%" stop-color="#ffd4e9"/><stop offset="100%" stop-color="#ffb3d7"/></radialGradient></defs>
          <g id="breath" transform-origin="60 80">
            <path id="heart" d="M60 100C44 86 18 68 18 44a20 20 0 0 1 38-10 20 20 0 0 1 38 10c0 24-26 42-34 56z" fill="url(#heartG)" stroke="#ff9ec7" stroke-width="3"/>
            <circle id="eyeL" cx="48" cy="50" r="4.2" fill="#111"/>
            <circle id="eyeR" cx="72" cy="50" r="4.2" fill="#111"/>
            <path id="mouth" d="M48 66 Q60 72 72 66" stroke="#111" stroke-width="3.2" fill="none" stroke-linecap="round"/>
            <path id="browL" d="M42 44 Q48 42 54 44" stroke="#111" stroke-width="2.6" fill="none" stroke-linecap="round"/>
            <path id="browR" d="M66 44 Q72 42 78 44" stroke="#111" stroke-width="2.6" fill="none" stroke-linecap="round"/>
            <rect id="lidL" x="44" y="42" width="8" height="8" rx="4" fill="#ffd4e9" opacity="0"/>
            <rect id="lidR" x="68" y="42" width="8" height="8" rx="4" fill="#ffd4e9" opacity="0"/>
          </g>
        </svg>
        <div id="bubble" class="bubble">Merhaba! CevabÄ±nÄ± heyecanla bekliyorum ğŸ’«</div>
      </div>

      <p class="tiny">Butonlar daima kart iÃ§inde kalÄ±r; â€œHayÄ±râ€ kaÃ§sa bile Ã§akÄ±ÅŸma yok.</p>
    </main>
  </section>

  <!-- Modern parallax bÃ¶lÃ¼mler -->
  <section class="parallax p1"><div>âœ¨ kÃ¼Ã§Ã¼k jestler bÃ¼yÃ¼k etkiler</div></section>
  <section class="parallax p2"><div>ğŸ’˜ doÄŸru zaman: ÅŸimdi</div></section>

  <svg width="0" height="0" style="position:absolute">
    <filter id="goo"><feGaussianBlur in="SourceGraphic" stdDeviation="4"/><feColorMatrix values="1 0 0 0 0  0 1 0 0 0  0 0 1 0 0  0 0 0 18 -7"/></filter>
  </svg>

<script>
(() => {
  const root = document.documentElement;
  const themes = ['mor','deniz','gunes','zumrut'];
  (function randomTheme(){ const pick = themes[Math.floor(Math.random()*themes.length)]; if(pick==='mor') root.removeAttribute('data-theme'); else root.setAttribute('data-theme', pick); })();

  /* ===== Elements ===== */
  const yes = document.getElementById('yes'), no = document.getElementById('no');
  const bubble = document.getElementById('bubble'), mouth = document.getElementById('mouth');
  const eyeL = document.getElementById('eyeL'), eyeR = document.getElementById('eyeR');
  const browL = document.getElementById('browL'), browR = document.getElementById('browR');
  const lidL = document.getElementById('lidL'), lidR = document.getElementById('lidR'), breath = document.getElementById('breath');
  const card = document.getElementById('card'), shine = card.querySelector('.shine');
  const buttonsWrap = document.getElementById('buttons'), ring = document.getElementById('ring');
  const fx = document.getElementById('fx'), confetti = document.getElementById('confetti');
  const tips = document.getElementById('tips');
  const mini = document.getElementById('mini'), arena = document.getElementById('arena'), catchBtn = document.getElementById('catch'), timerEl = document.getElementById('timer');
  const smart = document.getElementById('smart');
  const btnSmart = document.getElementById('btnSmart'), btnWA = document.getElementById('btnWA'), btnIG = document.getElementById('btnIG'), btnShare = document.getElementById('btnShare'), btnICS = document.getElementById('btnICS');
  const mute = document.getElementById('mute'), tts = document.getElementById('tts'), asr = document.getElementById('asr');

  /* ===== Micro-sound (beep/pop) ===== */
  let AC; const safeAC = ()=>{ AC = AC || new (window.AudioContext||window.webkitAudioContext)(); return AC; };
  function tone(freq=880, dur=0.07, type='sine', vol=0.08){
    if(mute.checked) return; const ac=safeAC(); const o=ac.createOscillator(), g=ac.createGain();
    o.type=type; o.frequency.value=freq; g.gain.value=vol; o.connect(g).connect(ac.destination);
    o.start(); g.gain.exponentialRampToValueAtTime(0.0001, ac.currentTime+dur); o.stop(ac.currentTime+dur);
  }
  const clickS = ()=> tone(660,0.05,'square',0.06);
  const heartS = ()=> tone(880,0.08,'sine',0.08);
  const confS  = ()=> { tone(560,0.05,'triangle',0.06); setTimeout(()=>tone(920,0.05,'triangle',0.06),60); };

  /* ===== 3D tilt + shine ===== */
  card.addEventListener('pointermove', (e)=>{ const r = card.getBoundingClientRect(), x=(e.clientX-r.left)/r.width, y=(e.clientY-r.top)/r.height; card.style.transform=`perspective(900px) rotateX(${(y-.5)*4}deg) rotateY(${(x-.5)*-6}deg)`; shine.style.setProperty('--mx', `${x*100}%`); shine.style.setProperty('--my', `${y*100}%`); });
  card.addEventListener('pointerleave', ()=>{ card.style.transform='none'; });

  /* ===== Avatar anim ===== */
  breath.animate([{transform:'scale(1)'},{transform:'scale(1.03)'}], {duration:2200, direction:'alternate', iterations:Infinity, easing:'ease-in-out'});
  const blink=()=>[lidL,lidR].forEach(el=> el.animate([{opacity:0},{opacity:1},{opacity:0}], {duration:140, easing:'ease-in-out'}));
  setInterval(()=>{ if(Math.random()<0.35) blink(); }, 2200);
  let ptr={x:0,y:0}; window.addEventListener('pointermove', e=> ptr={x:e.clientX,y:e.clientY});
  (function trackEyes(){ const r=card.getBoundingClientRect(), ex=(ptr.x-(r.left+r.width/2))/(r.width/2), ey=(ptr.y-(r.top+r.height/2))/(r.height/2), dx=Math.max(-3,Math.min(3,ex*3)), dy=Math.max(-3,Math.min(3,ey*3)); eyeL.setAttribute('cx',48+dx); eyeL.setAttribute('cy',50+dy); eyeR.setAttribute('cx',72+dx); eyeR.setAttribute('cy',50+dy); requestAnimationFrame(trackEyes); })();

  /* ===== Avatar ifadeleri ===== */
  function setFace(mode){
    const map={
      happy:  {m:'M48 64 Q60 78 72 64', bL:'M42 44 Q48 42 54 44', bR:'M66 44 Q72 42 78 44'},
      flat:   {m:'M48 68 Q60 68 72 68', bL:'M42 44 Q48 44 54 44', bR:'M66 44 Q72 44 78 44'},
      sad:    {m:'M48 73 Q60 62 72 73', bL:'M42 42 Q48 46 54 42', bR:'M66 42 Q72 46 78 42'},
      cheeky: {m:'M48 66 Q60 74 72 66', bL:'M42 43 Q48 41 54 43', bR:'M66 45 Q72 43 78 45'}
    };
    const s=map[mode]||map.flat; mouth.setAttribute('d',s.m); browL.setAttribute('d',s.bL); browR.setAttribute('d',s.bR);
  }

  /* ===== Texts / Growth / Ring ===== */
  const noTexts=["HayÄ±r","HAYIR.","Net: HayÄ±r âŒ","Asla.","Israr etme, hayÄ±r.","Konu kapandÄ±: HayÄ±r.","Son kararÄ±m: HayÄ±r.","HayÄ±r ve tekrar hayÄ±r.","HÃ¢lÃ¢ hayÄ±r.","Kesinlikle HAYIR."];
  let noCount=0, consecNo=0;
  const vibrate=(ms=14)=>(navigator.vibrate?.(ms));

  function setNoText(){ no.textContent = noTexts[Math.min(noCount, noTexts.length-1)]; }
  function applyYesGrowth(){
    const base=1+noCount*0.17, scale=Math.min(base,3.0), font=Math.min(1+noCount*0.09,2.0), padV=Math.min(16+noCount*2,30), padH=Math.min(24+noCount*7,70);
    root.style.setProperty('--yes-scale', scale); root.style.setProperty('--yes-font', `calc(1rem * ${font})`); root.style.setProperty('--yes-pad', `${padV}px ${padH}px`);
    const baseMin=120, extra=Math.round((scale-1)*66); root.style.setProperty('--btns-minh', `${baseMin+extra}px`);
    yes.animate([{transform:`scale(${scale*1.05})`},{transform:`scale(${scale})`}], {duration:200, easing:'cubic-bezier(.2,1.4,.2,1)'});
    const perc=Math.min(100,(scale-1)/(3.0-1)*100), dash=283*(1-perc/100); ring.style.strokeDashoffset = dash;
  }
  function mascotReact(){
    if(noCount===0){ setFace('happy'); bubble.textContent="Merhaba! CevabÄ±nÄ± heyecanla bekliyorum ğŸ’«"; }
    else if(noCount<=2){ setFace('flat'); bubble.textContent="Naz mÄ± yapÄ±yorsun? ğŸ™‚"; }
    else if(noCount<=5){ setFace('sad'); bubble.textContent="Ofâ€¦ yine hayÄ±r mÄ±?"; }
    else { setFace('cheeky'); bubble.textContent="Kalbim kÄ±rÄ±lÄ±yor ama pes etmiyorum ğŸ’§"; }
    bubble.animate([{transform:'scale(.95)', opacity:.9},{transform:'scale(1)', opacity:1}], {duration:160, easing:'ease-out'});
    if(tts.checked) speak(bubble.textContent);
  }

  /* ===== Smart speak / ASR ===== */
  function speak(text){ if(!tts.checked) return; speechSynthesis.cancel(); const u=new SpeechSynthesisUtterance(text); const tr=speechSynthesis.getVoices().find(v=>/tr|turk/i.test(v.lang)); if(tr) u.voice=tr; u.lang='tr-TR'; speechSynthesis.speak(u); }
  let recog=null; function startASR(){ const SR=window.SpeechRecognition||window.webkitSpeechRecognition; if(!SR){ asr.checked=false; alert("TarayÄ±cÄ± ses tanÄ±mayÄ± desteklemiyor."); return; } recog=new SR(); recog.lang='tr-TR'; recog.onresult=(e)=>{ const t=(e.results[0][0].transcript||"").toLowerCase(); if(t.includes("evet")) yes.click(); else if(t.includes("hayÄ±r")||t.includes("hayir")) no.click(); else speak("AnlamadÄ±m, evet mi hayÄ±r mÄ±?"); }; recog.onend=()=>{ if(asr.checked) recog.start(); }; recog.start(); }
  asr.addEventListener('change',()=>{ if(asr.checked) startASR(); else recog?.stop(); });

  /* ===== No evasive inside + no overlap ===== */
  function moveNoInside(){
    if(noCount < 3) return;
    no.classList.add('evasive');
    const wrapRect = buttonsWrap.getBoundingClientRect();
    const yesRect  = yes.getBoundingClientRect();
    const btnRect  = no.getBoundingClientRect();
    const maxLeft = wrapRect.width - btnRect.width - 8;
    const maxTop  = Math.max(0, wrapRect.height - btnRect.height - 8);
    const tries = 20;
    let finalLeft = 0, finalTop = 0;
    for(let i=0;i<tries;i++){
      const L = Math.max(0, Math.random()*maxLeft);
      const T = Math.max(0, Math.random()*maxTop);
      const test = {left:wrapRect.left+L, top:wrapRect.top+T, right:wrapRect.left+L+btnRect.width, bottom:wrapRect.top+T+btnRect.height};
      const overlap = !(test.right < yesRect.left || test.left > yesRect.right || test.bottom < yesRect.top || test.top > yesRect.bottom);
      if(!overlap){ finalLeft=L; finalTop=T; break; }
      if(i===tries-1){
        finalLeft = (yesRect.left-wrapRect.left > wrapRect.width/2) ? Math.max(0, yesRect.left-wrapRect.left-btnRect.width-12) : Math.min(maxLeft, yesRect.right-wrapRect.left+12);
        finalTop  = Math.min(maxTop, Math.abs(Math.random()*maxTop));
      }
    }
    no.style.left = finalLeft + 'px';
    no.style.top  = finalTop  + 'px';
  }

  /* ===== Gooey hearts + confetti ===== */
  function burstHearts(){
    const rect = yes.getBoundingClientRect();
    const baseX = rect.left + rect.width/2 - buttonsWrap.getBoundingClientRect().left;
    const pool = ['ğŸ’–','ğŸ’—','ğŸ’˜','ğŸ’'];
    for(let i=0;i<16;i++){
      const s=document.createElement('span'); s.className='heart'; s.textContent=pool[i%pool.length];
      s.style.left=(baseX+(Math.random()*120-60))+'px'; s.style.bottom='8px'; s.style.fontSize=(18+Math.random()*18)+'px'; s.style.animationDelay=(Math.random()*0.35)+'s';
      fx.appendChild(s); s.addEventListener('animationend', ()=> s.remove());
    }
  }
  function confettiBoom(){
    const area=buttonsWrap.getBoundingClientRect(), cs=getComputedStyle(root);
    const colors=[cs.getPropertyValue('--yes'), cs.getPropertyValue('--yes2'), cs.getPropertyValue('--no'), cs.getPropertyValue('--no2'), '#ffffff'];
    for(let i=0;i<70;i++){
      const d=document.createElement('div'); d.className='piece';
      d.style.left=(Math.random()*area.width)+'px'; d.style.bottom='0px'; d.style.background=colors[i%colors.length];
      d.style.transform=`translateY(${Math.random()*20}px) rotate(${Math.random()*360}deg)`; d.style.animationDelay=(Math.random()*0.4)+'s';
      confetti.appendChild(d); d.addEventListener('animationend', ()=> d.remove());
    }
  }

  /* ===== Tips carousel auto-scroll ===== */
  let tipIdx = 0; setInterval(()=>{ tipIdx=(tipIdx+1)%tips.children.length; tips.scrollTo({left: tips.children[tipIdx].offsetLeft - tips.clientWidth/2 + tips.children[tipIdx].clientWidth/2, behavior:'smooth'}); }, 2600);

  /* ===== Mini-Game: Catch the YES ===== */
  let miniTimer=0, intTimer=null, mover=null;
  function openMini(){
    mini.classList.add('show'); clickS();
    timerEl.textContent='10'; miniTimer=10;
    intTimer=setInterval(()=>{ miniTimer--; timerEl.textContent=miniTimer; if(miniTimer<=0){ closeMini(false); } }, 1000);
    // move button randomly inside arena
    const move = ()=>{
      const r=arena.getBoundingClientRect(), w=catchBtn.offsetWidth, h=catchBtn.offsetHeight;
      const x = Math.max(6, Math.random()*(r.width-w-12));
      const y = Math.max(6, Math.random()*(r.height-h-12));
      catchBtn.style.transform = `translate(${x}px, ${y}px)`;
    };
    move(); mover=setInterval(move, 550);
  }
  function closeMini(success){
    mini.classList.remove('show');
    clearInterval(intTimer); clearInterval(mover);
    if(success){ yes.click(); } else { bubble.textContent="Ahâ€¦ yakalayamadÄ±n. Bir daha dener miyiz?"; setFace('sad'); if(tts.checked) speak(bubble.textContent); }
  }
  catchBtn.addEventListener('click', ()=>{ heartS(); closeMini(true); });

  /* ===== Smart messaging / share / ICS ===== */
  const MSG=encodeURIComponent("Evet dedim! Ä°lk buluÅŸmayÄ± planlayalÄ±m mÄ±? ğŸ’˜");
  function openWA(){ const app=`whatsapp://send?text=${MSG}`, web=`https://wa.me/?text=${MSG}`; let b=false; const t=Date.now(); setTimeout(()=>{ if(!b && Date.now()-t<1200) window.open(web,'_blank'); },700); window.location.href=app; setTimeout(()=>b=true,1200); }
  function openIG(){ const app='instagram://direct', web='https://www.instagram.com/direct/inbox/'; let b=false; const t=Date.now(); setTimeout(()=>{ if(!b && Date.now()-t<1200) window.open(web,'_blank'); },700); window.location.href=app; setTimeout(()=>b=true,1200); }
  function openSmart(){ const m=/Android|iPhone|iPad|iPod/i.test(navigator.userAgent); if(m){ window.location.href=`whatsapp://send?text=${MSG}`; setTimeout(()=>{ window.location.href='instagram://direct'; },900); setTimeout(()=>{ window.open(`https://wa.me/?text=${MSG}`,'_blank'); },1800); } else { window.open(`https://wa.me/?text=${MSG}`,'_blank'); } }
  async function shareIt(){ if(navigator.share){ try{ await navigator.share({title:'Benimle Ã§Ä±kar mÄ±sÄ±n? ğŸ’—', text: decodeURIComponent(MSG), url: location.href}); }catch{} } else { window.open(`https://wa.me/?text=${MSG}`,'_blank'); } }
  function downloadICS(){
    const now=new Date(), day=now.getDay(), diff=(5-day+7)%7 || 7; const d=new Date(now.getFullYear(), now.getMonth(), now.getDate()+diff, 19, 0, 0);
    const end=new Date(d.getTime()+2*60*60*1000);
    const fmt=(x)=> x.toISOString().replace(/[-:]/g,'').split('.')[0]+'Z';
    const ics=`BEGIN:VCALENDAR
VERSION:2.0
CALSCALE:GREGORIAN
BEGIN:VEVENT
DTSTAMP:${fmt(new Date())}
DTSTART:${fmt(d)}
DTEND:${fmt(end)}
SUMMARY:Ä°lk BuluÅŸma ğŸ’˜
DESCRIPTION:Åahane bir akÅŸam iÃ§in buluÅŸuyoruz!
END:VEVENT
END:VCALENDAR`;
    const blob=new Blob([ics],{type:'text/calendar'}); const a=document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='ilk-bulusma.ics'; document.body.appendChild(a); a.click(); a.remove();
  }

  /* ===== Interactions ===== */
  function setNoTextUI(){ setNoText(); }
  no.addEventListener('click', ()=>{
    noCount++; consecNo++; clickS();
    applyYesGrowth(); setNoTextUI(); mascotReact(); moveNoInside(); vibrate(12);
    if(consecNo>0 && consecNo%3===0) openMini();
  });

  function onYes(){
    consecNo=0; heartS(); confS();
    burstHearts(); confettiBoom(); vibrate(22);
    bubble.textContent = "YAAAÅASIN! ğŸ‰ Bir mesaj atÄ±p planÄ± konuÅŸalÄ±m mÄ±?"; if(tts.checked) speak(bubble.textContent);
    setFace('happy');
    no.disabled = true; no.style.opacity=.4;
    yes.textContent="AnlaÅŸtÄ±k ğŸ’"; yes.disabled=true;
    smart.classList.add('show');
  }
  yes.addEventListener('click', onYes);

  btnSmart.addEventListener('click', openSmart);
  btnWA.addEventListener('click', openWA);
  btnIG.addEventListener('click', openIG);
  btnShare.addEventListener('click', shareIt);
  btnICS.addEventListener('click', downloadICS);
  ;[yes,no,btnSmart,btnWA,btnIG,btnShare,btnICS].forEach(el=> el.addEventListener('keyup', e=>{ if(e.key==='Enter'||e.key===' ') el.click(); }));

  // init
  (function init(){
    const rootThemes=['mor','deniz','gunes','zumrut']; // sadece okunur
    setNoTextUI(); applyYesGrowth();
    // auto-scroll tips ilk Ã¶ÄŸe hizalansÄ±n
    tips.scrollTo({left:0});
  })();
})();
</script>
</body>
</html>
